"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2786],{2786:function(e,r,t){t.r(r),t.d(r,{default:function(){return l}});var o=t(7437),n=t(5583),a=t(1780),s=t(2265),i=t(3113),c=e=>{let{onClose:r}=e,[t,c]=(0,s.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[l,d]=(0,s.useState)(null),[u,g]=(0,s.useState)(!1),[m,h]=(0,s.useState)({current:!1,new:!1,confirm:!1}),p=e=>{c((0,a._)((0,n._)({},t),{[e.target.name]:e.target.value}))},x=async e=>{if(e.preventDefault(),d(null),t.newPassword!==t.confirmPassword){d({type:"error",text:"New passwords do not match. Please try again."});return}if(t.newPassword.length<6){d({type:"error",text:"New password must be at least 6 characters long."});return}g(!0);try{let e={currentPassword:t.currentPassword,newPassword:t.newPassword,confirmPassword:t.confirmPassword},o=await i.Ew.changeOperatorPassword(e);d({type:"success",text:o.data.message||"Updated successfully!"}),setTimeout(()=>{r()},2e3)}catch(e){var o,n;d({type:"error",text:(null===(n=e.response)||void 0===n?void 0:null===(o=n.data)||void 0===o?void 0:o.message)||"Update failed. Please try again."})}finally{g(!1)}},w=e=>{h(r=>(0,a._)((0,n._)({},r),{[e]:!r[e]}))};return(0,o.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-60 flex justify-center items-center z-50 transition-opacity duration-300",children:(0,o.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-lg transform transition-all duration-300 animate-fade-in-up",children:[(0,o.jsxs)("div",{className:"flex items-start justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,o.jsx)("div",{className:"p-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl",children:(0,o.jsx)("svg",{className:"h-6 w-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Change Password"}),(0,o.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"Update your account password."})]})]}),(0,o.jsx)("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-white",children:(0,o.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,o.jsxs)("form",{onSubmit:x,className:"p-6 space-y-6",children:[(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Current Password ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{type:m.current?"text":"password",name:"currentPassword",value:t.currentPassword,onChange:p,required:!0,className:"w-full pl-4 pr-12 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,o.jsx)("button",{type:"button",onClick:()=>w("current"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m.current?(0,o.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242"})}):(0,o.jsxs)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["New Password ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{type:m.new?"text":"password",name:"newPassword",value:t.newPassword,onChange:p,required:!0,className:"w-full pl-4 pr-12 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,o.jsx)("button",{type:"button",onClick:()=>w("new"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m.new?(0,o.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242"})}):(0,o.jsxs)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Confirm New Password ",(0,o.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("input",{type:m.confirm?"text":"password",name:"confirmPassword",value:t.confirmPassword,onChange:p,required:!0,className:"w-full pl-4 pr-12 py-3 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,o.jsx)("button",{type:"button",onClick:()=>w("confirm"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:m.confirm?(0,o.jsx)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242"})}):(0,o.jsxs)("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),l&&(0,o.jsx)("div",{className:"flex items-center p-4 rounded-lg ".concat("success"===l.type?"bg-green-50 text-green-800":"bg-red-50 text-red-800"),children:l.text}),(0,o.jsxs)("div",{className:"flex justify-end space-x-4 pt-4",children:[(0,o.jsx)("button",{type:"button",onClick:r,className:"px-6 py-3 border rounded-lg text-sm font-medium",children:"Cancel"}),(0,o.jsx)("button",{type:"submit",disabled:u,className:"px-6 py-3 border rounded-lg text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-purple-600 disabled:opacity-50 flex items-center",children:u?"Updating...":"Change Password"})]})]})]})})};function l(){return(0,o.jsx)(c,{onClose:()=>{window.history.back()}})}},3113:function(e,r,t){t.d(r,{$E:function(){return p},CU:function(){return l},EM:function(){return u},Ew:function(){return f},Ir:function(){return h},M8:function(){return w},O7:function(){return d},Z6:function(){return m},n9:function(){return g},rR:function(){return x}});var o=t(3464),n=t(8468);let a=!1,s=[],i=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s.forEach(t=>{e?t.reject(e):t.resolve(r)}),s=[]},c=o.Z.create({baseURL:"/api",withCredentials:!0});c.interceptors.request.use(e=>{var r;return console.log("\uD83D\uDE80 API Request:",null===(r=e.method)||void 0===r?void 0:r.toUpperCase(),e.baseURL+e.url),e},e=>(console.error("âŒ API Request Error:",e),Promise.reject(e))),c.interceptors.request.use(e=>{let r=(0,n.bW)();return r&&e.url.includes("/admin/")&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),c.interceptors.response.use(e=>{if(e.config.url.includes("/admin/login")&&e.data.accessToken&&((0,n.uB)(e.data.accessToken),e.data.role))try{sessionStorage.setItem("astrox_admin_role_session",e.data.role)}catch(e){}return e},async e=>{var r,t,o,l,d,u,g,m,h;let p=e.config;if((null===(r=e.response)||void 0===r?void 0:r.status)===401){if(p.url.includes("/admin/login"))return null===(u=e.response)||void 0===u||null===(d=u.data)||void 0===d||null===(l=d.message)||void 0===l||l.includes("deactivated"),Promise.reject(e);if(p.url.includes("/admin/refresh-token"))return(0,n.uB)(null),i(e),window.location.href="/login",Promise.reject(e);if(a)return new Promise(function(e,r){s.push({resolve:e,reject:r})}).then(e=>(p.headers.Authorization="Bearer ".concat(e),c(p))).catch(e=>Promise.reject(e));a=!0;try{let e;try{e=await c.post("/admin/refresh-token")}catch(t){let r=window.sessionStorage.getItem("astrox_last_refresh_token");if(!r)throw t;e=await c.post("/admin/refresh-token",{refreshToken:r},{headers:{"x-refresh-token":r}})}let r=e.data.accessToken;if((0,n.uB)(r),e.data.role)try{sessionStorage.setItem("astrox_admin_role_session",e.data.role)}catch(e){}return i(null,r),a=!1,p.headers.Authorization="Bearer ".concat(r),c(p)}catch(e){return(0,n.uB)(null),i(e),a=!1,window.location.href="/login",Promise.reject(e)}}return(null===(t=e.response)||void 0===t?void 0:t.status)===403?(null===(h=e.response)||void 0===h?void 0:null===(m=h.data)||void 0===m?void 0:null===(g=m.message)||void 0===g?void 0:g.includes("deactivated"))&&((0,n.uB)(null),window.location.href="/login"):console.error("Response Interceptor: Unhandled API error for",null===(o=e.config)||void 0===o?void 0:o.url,":",e.message),Promise.reject(e)});let l=async e=>{try{return(await c.post("/subscribers",{email:e})).data}catch(e){throw console.error("Error during subscription API call:",e),e}},d=async e=>{try{return(await c.post("/blogs/".concat(e,"/share"))).data}catch(e){throw console.error("Error incrementing share count:",e),e}},u=async e=>{try{return(await c.patch("/blogs/".concat(e,"/views"))).data}catch(e){throw console.error("Error incrementing view count:",e),e}},g=async(e,r)=>{try{return(await c.post("/blogs/".concat(e,"/like"),{visitorId:r})).data}catch(e){throw console.error("Error liking post:",e),e}},m=async(e,r)=>{try{return(await c.post("/blogs/".concat(e,"/unlike"),{visitorId:r})).data}catch(e){throw console.error("Error unliking post:",e),e}},h=async(e,r)=>{try{return(await c.post("/blogs/".concat(e,"/comments"),r)).data}catch(e){throw console.error("Error adding comment:",e),e}},p=async(e,r)=>{try{return(await c.get("/blogs/".concat(e,"/").concat(r))).data}catch(e){throw console.error("Error fetching blog by category and slug:",e),e}},x=async e=>{try{return(await c.get("/blogs/slug/".concat(e))).data}catch(e){throw console.error("Error fetching blog by slug:",e),e}},w=e=>{e?(0,n.uB)(e):(0,n.H6)()},f={login:e=>c.post("/admin/login",e),logout:()=>c.post("/admin/logout"),getOperators:()=>c.get("/admin/operators"),createOperator:e=>c.post("/admin/operators",e),deleteOperator:e=>c.delete("/admin/operators/".concat(e)),toggleOperatorStatus:e=>c.put("/admin/operators/".concat(e,"/toggle")),updateAdminCredentials:e=>c.put("/admin/credentials",e),updateOperatorCredentials:e=>c.put("/admin/operator/credentials",e),changeAdminPassword:e=>c.put("/admin/change-password",e),changeOperatorPassword:e=>c.put("/admin/operator/change-password",e),getBlogs:e=>c.get("/admin/blogs",e),searchBlogs:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return c.get("/admin/blogs/search?q=".concat(e,"&page=").concat(r))},createBlog:e=>c.post("/admin/blogs",e),updateBlog:(e,r)=>c.put("/admin/blogs/".concat(e),r),deleteBlog:e=>c.delete("/admin/blogs/".concat(e)),updateBlogDate:(e,r)=>c.put("/admin/blogs/".concat(e,"/date"),{date:r}),getPendingBlogs:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.get("/admin/blogs/pending",e)},approveBlog:e=>c.post("/admin/blogs/".concat(e,"/approve")),rejectBlog:e=>c.post("/admin/blogs/".concat(e,"/reject")),getCategories:()=>c.get("/admin/categories"),createCategory:e=>c.post("/admin/categories",e),updateCategory:(e,r)=>c.put("/admin/categories/".concat(e),r),deleteCategory:e=>c.delete("/admin/categories/".concat(e)),getSubscribers:()=>c.get("/admin/subscribers"),getSubscriberStats:()=>c.get("/admin/subscribers/stats")};r.ZP=c},8468:function(e,r,t){t.d(r,{H6:function(){return i},OP:function(){return l},Xs:function(){return u},bW:function(){return s},uB:function(){return a}});let o="astrox_admin_auth_token",n=()=>{try{let e=sessionStorage.getItem("astrox_admin_role_session");if(e)return e}catch(e){}return"admin"},a=e=>{try{let r=n(),t="".concat(o,"_").concat(r);e?localStorage.setItem(t,e):console.warn("Attempted to set a null or undefined auth token.")}catch(e){console.error("Error saving admin auth token to localStorage:",e)}},s=()=>{try{let e=n(),r="".concat(o,"_").concat(e);return localStorage.getItem(r)}catch(e){return console.error("Error retrieving admin auth token from localStorage:",e),null}},i=()=>{try{let e=n(),r="".concat(o,"_").concat(e);localStorage.removeItem(r)}catch(e){console.error("Error removing admin auth token from localStorage:",e)}},c="astrox_visitor_id",l=()=>{try{let e=localStorage.getItem(c);return e||(e="visitor_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),localStorage.setItem(c,e)),e}catch(e){return console.error("Error managing visitor ID:",e),"visitor_".concat(Date.now())}},d=()=>{try{return localStorage.getItem("astrox_subscriber_id")}catch(e){return console.error("Error retrieving subscriber ID:",e),null}},u=()=>!!d()}}]);