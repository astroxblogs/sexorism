"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7069],{3874:function(e,t,r){r.d(t,{J:function(){return s},U:function(){return c}});var o=r(7437),n=r(2265);let a=(0,n.createContext)(),c=()=>(0,n.useContext)(a),s=e=>{let{children:t}=e,[r,c]=(0,n.useState)([]),[s,i]=(0,n.useState)([]),l=(0,n.useCallback)(e=>{c(t=>t.map(t=>t._id===e._id?e:t)),i(t=>t.map(t=>t._id===e._id?e:t))},[]);return(0,o.jsx)(a.Provider,{value:{blogs:r,setBlogs:c,featuredBlogs:s,setFeaturedBlogs:i,updateBlog:l},children:t})}},4553:function(e,t,r){r.d(t,{S:function(){return u},Y:function(){return l}});var o=r(5583),n=r(1780),a=r(7437),c=r(2265),s=r(3113);let i=(0,c.createContext)(),l=e=>{let{children:t}=e,[r,l]=(0,c.useState)({}),u=(0,c.useCallback)(e=>r[e]||0,[r]),d=(0,c.useCallback)((e,t)=>{l(r=>void 0!==r[e]?r:(0,n._)((0,o._)({},r),{[e]:t}))},[]),g=(0,c.useCallback)(async e=>{try{var t;let a=await (0,s.O7)(e),c=null!==(t=null==a?void 0:a.shareCount)&&void 0!==t?t:(r[e]||0)+1;return l(t=>(0,n._)((0,o._)({},t),{[e]:c})),c}catch(a){let t=(r[e]||0)+1;return l(r=>(0,n._)((0,o._)({},r),{[e]:t})),t}},[r]);return(0,a.jsx)(i.Provider,{value:{shareCounts:r,getShareCount:u,incrementShareCount:g,setInitialShareCount:d},children:t})},u=()=>(0,c.useContext)(i)},3113:function(e,t,r){r.d(t,{$E:function(){return p},CU:function(){return l},EM:function(){return d},Ew:function(){return b},Ir:function(){return h},M8:function(){return v},O7:function(){return u},Z6:function(){return m},n9:function(){return g},rR:function(){return f}});var o=r(3464),n=r(8468);let a=!1,c=[],s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;c.forEach(r=>{e?r.reject(e):r.resolve(t)}),c=[]},i=o.Z.create({baseURL:"/api",withCredentials:!0});i.interceptors.request.use(e=>{var t;return console.log("\uD83D\uDE80 API Request:",null===(t=e.method)||void 0===t?void 0:t.toUpperCase(),e.baseURL+e.url),e},e=>(console.error("âŒ API Request Error:",e),Promise.reject(e))),i.interceptors.request.use(e=>{let t=(0,n.bW)();return t&&e.url.includes("/admin/")&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),i.interceptors.response.use(e=>{if(e.config.url.includes("/admin/login")&&e.data.accessToken&&((0,n.uB)(e.data.accessToken),e.data.role))try{sessionStorage.setItem("astrox_admin_role_session",e.data.role)}catch(e){}return e},async e=>{var t,r,o,l,u,d,g,m,h;let p=e.config;if((null===(t=e.response)||void 0===t?void 0:t.status)===401){if(p.url.includes("/admin/login"))return null===(d=e.response)||void 0===d||null===(u=d.data)||void 0===u||null===(l=u.message)||void 0===l||l.includes("deactivated"),Promise.reject(e);if(p.url.includes("/admin/refresh-token"))return(0,n.uB)(null),s(e),window.location.href="/login",Promise.reject(e);if(a)return new Promise(function(e,t){c.push({resolve:e,reject:t})}).then(e=>(p.headers.Authorization="Bearer ".concat(e),i(p))).catch(e=>Promise.reject(e));a=!0;try{let e;try{e=await i.post("/admin/refresh-token")}catch(r){let t=window.sessionStorage.getItem("astrox_last_refresh_token");if(!t)throw r;e=await i.post("/admin/refresh-token",{refreshToken:t},{headers:{"x-refresh-token":t}})}let t=e.data.accessToken;if((0,n.uB)(t),e.data.role)try{sessionStorage.setItem("astrox_admin_role_session",e.data.role)}catch(e){}return s(null,t),a=!1,p.headers.Authorization="Bearer ".concat(t),i(p)}catch(e){return(0,n.uB)(null),s(e),a=!1,window.location.href="/login",Promise.reject(e)}}return(null===(r=e.response)||void 0===r?void 0:r.status)===403?(null===(h=e.response)||void 0===h?void 0:null===(m=h.data)||void 0===m?void 0:null===(g=m.message)||void 0===g?void 0:g.includes("deactivated"))&&((0,n.uB)(null),window.location.href="/login"):console.error("Response Interceptor: Unhandled API error for",null===(o=e.config)||void 0===o?void 0:o.url,":",e.message),Promise.reject(e)});let l=async e=>{try{return(await i.post("/subscribers",{email:e})).data}catch(e){throw console.error("Error during subscription API call:",e),e}},u=async e=>{try{return(await i.post("/blogs/".concat(e,"/share"))).data}catch(e){throw console.error("Error incrementing share count:",e),e}},d=async e=>{try{return(await i.patch("/blogs/".concat(e,"/views"))).data}catch(e){throw console.error("Error incrementing view count:",e),e}},g=async(e,t)=>{try{return(await i.post("/blogs/".concat(e,"/like"),{visitorId:t})).data}catch(e){throw console.error("Error liking post:",e),e}},m=async(e,t)=>{try{return(await i.post("/blogs/".concat(e,"/unlike"),{visitorId:t})).data}catch(e){throw console.error("Error unliking post:",e),e}},h=async(e,t)=>{try{return(await i.post("/blogs/".concat(e,"/comments"),t)).data}catch(e){throw console.error("Error adding comment:",e),e}},p=async(e,t)=>{try{return(await i.get("/blogs/".concat(e,"/").concat(t))).data}catch(e){throw console.error("Error fetching blog by category and slug:",e),e}},f=async e=>{try{return(await i.get("/blogs/slug/".concat(e))).data}catch(e){throw console.error("Error fetching blog by slug:",e),e}},v=e=>{e?(0,n.uB)(e):(0,n.H6)()},b={login:e=>i.post("/admin/login",e),logout:()=>i.post("/admin/logout"),getOperators:()=>i.get("/admin/operators"),createOperator:e=>i.post("/admin/operators",e),deleteOperator:e=>i.delete("/admin/operators/".concat(e)),toggleOperatorStatus:e=>i.put("/admin/operators/".concat(e,"/toggle")),updateAdminCredentials:e=>i.put("/admin/credentials",e),updateOperatorCredentials:e=>i.put("/admin/operator/credentials",e),changeAdminPassword:e=>i.put("/admin/change-password",e),changeOperatorPassword:e=>i.put("/admin/operator/change-password",e),getBlogs:e=>i.get("/admin/blogs",e),searchBlogs:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i.get("/admin/blogs/search?q=".concat(e,"&page=").concat(t))},createBlog:e=>i.post("/admin/blogs",e),updateBlog:(e,t)=>i.put("/admin/blogs/".concat(e),t),deleteBlog:e=>i.delete("/admin/blogs/".concat(e)),updateBlogDate:(e,t)=>i.put("/admin/blogs/".concat(e,"/date"),{date:t}),getPendingBlogs:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.get("/admin/blogs/pending",e)},approveBlog:e=>i.post("/admin/blogs/".concat(e,"/approve")),rejectBlog:e=>i.post("/admin/blogs/".concat(e,"/reject")),getCategories:()=>i.get("/admin/categories"),createCategory:e=>i.post("/admin/categories",e),updateCategory:(e,t)=>i.put("/admin/categories/".concat(e),t),deleteCategory:e=>i.delete("/admin/categories/".concat(e)),getSubscribers:()=>i.get("/admin/subscribers"),getSubscriberStats:()=>i.get("/admin/subscribers/stats")};t.ZP=i},8468:function(e,t,r){r.d(t,{H6:function(){return s},OP:function(){return l},Xs:function(){return d},bW:function(){return c},uB:function(){return a}});let o="astrox_admin_auth_token",n=()=>{try{let e=sessionStorage.getItem("astrox_admin_role_session");if(e)return e}catch(e){}return"admin"},a=e=>{try{let t=n(),r="".concat(o,"_").concat(t);e?localStorage.setItem(r,e):console.warn("Attempted to set a null or undefined auth token.")}catch(e){console.error("Error saving admin auth token to localStorage:",e)}},c=()=>{try{let e=n(),t="".concat(o,"_").concat(e);return localStorage.getItem(t)}catch(e){return console.error("Error retrieving admin auth token from localStorage:",e),null}},s=()=>{try{let e=n(),t="".concat(o,"_").concat(e);localStorage.removeItem(t)}catch(e){console.error("Error removing admin auth token from localStorage:",e)}},i="astrox_visitor_id",l=()=>{try{let e=localStorage.getItem(i);return e||(e="visitor_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),localStorage.setItem(i,e)),e}catch(e){return console.error("Error managing visitor ID:",e),"visitor_".concat(Date.now())}},u=()=>{try{return localStorage.getItem("astrox_subscriber_id")}catch(e){return console.error("Error retrieving subscriber ID:",e),null}},d=()=>!!u()}}]);