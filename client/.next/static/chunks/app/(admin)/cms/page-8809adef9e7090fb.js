(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2413],{9481:function(e,r,t){Promise.resolve().then(t.bind(t,1758))},1758:function(e,r,t){"use strict";t.r(r);var o=t(5583),n=t(1780),a=t(7437),s=t(2265),i=t(9376),c=t(3113);r.default=()=>{let[e,r]=(0,s.useState)({username:"",password:""}),[t,l]=(0,s.useState)(!1),[u,d]=(0,s.useState)(""),g=(0,i.useRouter)(),m=t=>{r((0,n._)((0,o._)({},e),{[t.target.name]:t.target.value}))},h=async r=>{r.preventDefault(),l(!0),d("");try{let r=await c.Ew.login(e);r.data.accessToken&&(document.cookie="token=".concat(r.data.accessToken,"; path=/; max-age=86400"),r.data.role&&sessionStorage.setItem("astrox_admin_role_session",r.data.role),r.data.refreshToken&&sessionStorage.setItem("astrox_last_refresh_token",r.data.refreshToken),g.push("/cms/admin-dashboard"))}catch(e){var t,o;d((null===(o=e.response)||void 0===o?void 0:null===(t=o.data)||void 0===t?void 0:t.message)||"Login failed")}finally{l(!1)}};return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsx)("div",{children:(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Admin Login"})}),(0,a.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:h,children:[u&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:u}),(0,a.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"username",name:"username",type:"text",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Username",value:e.username,onChange:m})}),(0,a.jsx)("div",{children:(0,a.jsx)("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:e.password,onChange:m})})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{type:"submit",disabled:t,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:t?"Signing in...":"Sign in"})})]})]})})}},3113:function(e,r,t){"use strict";t.d(r,{$E:function(){return p},CU:function(){return l},EM:function(){return d},Ew:function(){return v},Ir:function(){return h},M8:function(){return b},O7:function(){return u},Z6:function(){return m},n9:function(){return g},rR:function(){return f}});var o=t(3464),n=t(8468);let a=!1,s=[],i=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;s.forEach(t=>{e?t.reject(e):t.resolve(r)}),s=[]},c=o.Z.create({baseURL:"/api",withCredentials:!0});c.interceptors.request.use(e=>{var r;return console.log("\uD83D\uDE80 API Request:",null===(r=e.method)||void 0===r?void 0:r.toUpperCase(),e.baseURL+e.url),e},e=>(console.error("âŒ API Request Error:",e),Promise.reject(e))),c.interceptors.request.use(e=>{let r=(0,n.bW)();return r&&e.url.includes("/admin/")&&(e.headers.Authorization="Bearer ".concat(r)),e},e=>Promise.reject(e)),c.interceptors.response.use(e=>{if(e.config.url.includes("/admin/login")&&e.data.accessToken&&((0,n.uB)(e.data.accessToken),e.data.role))try{sessionStorage.setItem("astrox_admin_role_session",e.data.role)}catch(e){}return e},async e=>{var r,t,o,l,u,d,g,m,h;let p=e.config;if((null===(r=e.response)||void 0===r?void 0:r.status)===401){if(p.url.includes("/admin/login"))return null===(d=e.response)||void 0===d||null===(u=d.data)||void 0===u||null===(l=u.message)||void 0===l||l.includes("deactivated"),Promise.reject(e);if(p.url.includes("/admin/refresh-token"))return(0,n.uB)(null),i(e),window.location.href="/login",Promise.reject(e);if(a)return new Promise(function(e,r){s.push({resolve:e,reject:r})}).then(e=>(p.headers.Authorization="Bearer ".concat(e),c(p))).catch(e=>Promise.reject(e));a=!0;try{let e;try{e=await c.post("/admin/refresh-token")}catch(t){let r=window.sessionStorage.getItem("astrox_last_refresh_token");if(!r)throw t;e=await c.post("/admin/refresh-token",{refreshToken:r},{headers:{"x-refresh-token":r}})}let r=e.data.accessToken;if((0,n.uB)(r),e.data.role)try{sessionStorage.setItem("astrox_admin_role_session",e.data.role)}catch(e){}return i(null,r),a=!1,p.headers.Authorization="Bearer ".concat(r),c(p)}catch(e){return(0,n.uB)(null),i(e),a=!1,window.location.href="/login",Promise.reject(e)}}return(null===(t=e.response)||void 0===t?void 0:t.status)===403?(null===(h=e.response)||void 0===h?void 0:null===(m=h.data)||void 0===m?void 0:null===(g=m.message)||void 0===g?void 0:g.includes("deactivated"))&&((0,n.uB)(null),window.location.href="/login"):console.error("Response Interceptor: Unhandled API error for",null===(o=e.config)||void 0===o?void 0:o.url,":",e.message),Promise.reject(e)});let l=async e=>{try{return(await c.post("/subscribers",{email:e})).data}catch(e){throw console.error("Error during subscription API call:",e),e}},u=async e=>{try{return(await c.post("/blogs/".concat(e,"/share"))).data}catch(e){throw console.error("Error incrementing share count:",e),e}},d=async e=>{try{return(await c.patch("/blogs/".concat(e,"/views"))).data}catch(e){throw console.error("Error incrementing view count:",e),e}},g=async(e,r)=>{try{return(await c.post("/blogs/".concat(e,"/like"),{visitorId:r})).data}catch(e){throw console.error("Error liking post:",e),e}},m=async(e,r)=>{try{return(await c.post("/blogs/".concat(e,"/unlike"),{visitorId:r})).data}catch(e){throw console.error("Error unliking post:",e),e}},h=async(e,r)=>{try{return(await c.post("/blogs/".concat(e,"/comments"),r)).data}catch(e){throw console.error("Error adding comment:",e),e}},p=async(e,r)=>{try{return(await c.get("/blogs/".concat(e,"/").concat(r))).data}catch(e){throw console.error("Error fetching blog by category and slug:",e),e}},f=async e=>{try{return(await c.get("/blogs/slug/".concat(e))).data}catch(e){throw console.error("Error fetching blog by slug:",e),e}},b=e=>{e?(0,n.uB)(e):(0,n.H6)()},v={login:e=>c.post("/admin/login",e),logout:()=>c.post("/admin/logout"),getOperators:()=>c.get("/admin/operators"),createOperator:e=>c.post("/admin/operators",e),deleteOperator:e=>c.delete("/admin/operators/".concat(e)),toggleOperatorStatus:e=>c.put("/admin/operators/".concat(e,"/toggle")),updateAdminCredentials:e=>c.put("/admin/credentials",e),updateOperatorCredentials:e=>c.put("/admin/operator/credentials",e),changeAdminPassword:e=>c.put("/admin/change-password",e),changeOperatorPassword:e=>c.put("/admin/operator/change-password",e),getBlogs:e=>c.get("/admin/blogs",e),searchBlogs:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return c.get("/admin/blogs/search?q=".concat(e,"&page=").concat(r))},createBlog:e=>c.post("/admin/blogs",e),updateBlog:(e,r)=>c.put("/admin/blogs/".concat(e),r),deleteBlog:e=>c.delete("/admin/blogs/".concat(e)),updateBlogDate:(e,r)=>c.put("/admin/blogs/".concat(e,"/date"),{date:r}),getPendingBlogs:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.get("/admin/blogs/pending",e)},approveBlog:e=>c.post("/admin/blogs/".concat(e,"/approve")),rejectBlog:e=>c.post("/admin/blogs/".concat(e,"/reject")),getCategories:()=>c.get("/admin/categories"),createCategory:e=>c.post("/admin/categories",e),updateCategory:(e,r)=>c.put("/admin/categories/".concat(e),r),deleteCategory:e=>c.delete("/admin/categories/".concat(e)),getSubscribers:()=>c.get("/admin/subscribers"),getSubscriberStats:()=>c.get("/admin/subscribers/stats")};r.ZP=c},8468:function(e,r,t){"use strict";t.d(r,{H6:function(){return i},OP:function(){return l},Xs:function(){return d},bW:function(){return s},uB:function(){return a}});let o="astrox_admin_auth_token",n=()=>{try{let e=sessionStorage.getItem("astrox_admin_role_session");if(e)return e}catch(e){}return"admin"},a=e=>{try{let r=n(),t="".concat(o,"_").concat(r);e?localStorage.setItem(t,e):console.warn("Attempted to set a null or undefined auth token.")}catch(e){console.error("Error saving admin auth token to localStorage:",e)}},s=()=>{try{let e=n(),r="".concat(o,"_").concat(e);return localStorage.getItem(r)}catch(e){return console.error("Error retrieving admin auth token from localStorage:",e),null}},i=()=>{try{let e=n(),r="".concat(o,"_").concat(e);localStorage.removeItem(r)}catch(e){console.error("Error removing admin auth token from localStorage:",e)}},c="astrox_visitor_id",l=()=>{try{let e=localStorage.getItem(c);return e||(e="visitor_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),localStorage.setItem(c,e)),e}catch(e){return console.error("Error managing visitor ID:",e),"visitor_".concat(Date.now())}},u=()=>{try{return localStorage.getItem("astrox_subscriber_id")}catch(e){return console.error("Error retrieving subscriber ID:",e),null}},d=()=>!!u()},9376:function(e,r,t){"use strict";var o=t(5475);t.o(o,"useParams")&&t.d(r,{useParams:function(){return o.useParams}}),t.o(o,"usePathname")&&t.d(r,{usePathname:function(){return o.usePathname}}),t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}}),t.o(o,"useSearchParams")&&t.d(r,{useSearchParams:function(){return o.useSearchParams}})}},function(e){e.O(0,[3464,2971,2117,1744],function(){return e(e.s=9481)}),_N_E=e.O()}]);